{
    "collab_server" : "",
    "contents" : "#propensity scores\n# install.packages(\"wakefield\")\nlibrary(wakefield)\nset.seed(1234)\ndf.patients <- r_data_frame(n = 250, \n                            age(x = 30:78, \n                                name = 'Age'), \n                            sex(x = c(\"Male\", \"Female\"), \n                                prob = c(0.70, 0.30), \n                                name = \"Sex\"))\ndf.patients$Sample <- as.factor('Patients')\nsummary(df.patients)\npacman::p_load(dplyr, tidyr, ggplot2)\n\nset.seed(1234)\ndf.population <- r_data_frame(n = 1000, \n                              age(x = 18:80, \n                                  name = 'Age'), \n                              sex(x = c(\"Male\", \"Female\"), \n                                  prob = c(0.50, 0.50), \n                                  name = \"Sex\"))\ndf.population$Sample <- as.factor('Population')\nsummary(df.population)\n\nmydata <- rbind(df.patients, df.population)\nmydata$Group <- as.logical(mydata$Sample == 'Patients')\nmydata$Distress <- ifelse(mydata$Sex == 'Male', age(nrow(mydata), x = 0:42, name = 'Distress'),\n                          age(nrow(mydata), x = 15:42, name = 'Distress'))\n\npacman::p_load(tableone)\ntable1 <- CreateTableOne(vars = c('Age', 'Sex', 'Distress'), \n                         data = mydata, \n                         factorVars = 'Sex', \n                         strata = 'Sample')\ntable1 <- print(table1, \n                printToggle = FALSE, \n                noSpaces = TRUE)\nlibrary(knitr)\nkable(table1[,1:3],  \n      align = 'c', \n      caption = 'Table 1: Comparison of unmatched samples')\n\nset.seed(1234)\nmatch.it <- matchit(Group ~ Age + Sex, data = mydata, method=\"nearest\", ratio=1)\na <- summary(match.it)\n\nkable(a$nn, digits = 2, align = 'c', \n      caption = 'Table 2: Sample sizes')\n\nkable(a$sum.matched[c(1,2,4)], digits = 2, align = 'c', \n      caption = 'Table 3: Summary of balance for matched data')\n\nplot(match.it, type = 'jitter', interactive = FALSE)\n\ndf.match <- match.data(match.it)[1:ncol(mydata)]\nrm(df.patients, df.population)\n\ntable4 <- CreateTableOne(vars = c('Age', 'Sex', 'Distress'), \n                         data = df.match, \n                         factorVars = 'Sex', \n                         strata = 'Sample')\ntable4 <- print(table4, \n                printToggle = FALSE, \n                noSpaces = TRUE)\nkable(table4[,1:3],  \n      align = 'c', \n      caption = 'Table 4: Comparison of matched samples')\n",
    "created" : 1547793404967.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2691186070",
    "id" : "31162A2B",
    "lastKnownWriteTime" : 1547796123,
    "last_content_update" : 1547796123452,
    "path" : "~/R_Projects/interestingR/Rfile/201801/0118_R_for_matching_samples_propensity_score.R",
    "project_path" : "Rfile/201801/0118_R_for_matching_samples_propensity_score.R",
    "properties" : {
    },
    "relative_order" : 22,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}